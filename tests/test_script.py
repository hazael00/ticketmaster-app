# ticketmaster-app/tests/test_script.py
from dotenv import load_dotenv
from pathlib import Path
import os

from app.events_lookup import format_date_string
from app.events_lookup import format_date_time_string
from app.events_lookup import build_request_url
from app.events_lookup import parse_response
from app.events_lookup import events


def test_format_date_string():
    test_date = "2018-09-22"
    expected_result = "September 22, 2018"
    result = format_date_string(test_date)
    assert result == expected_result

def test_format_date_time_string():
    test_date_time = "19:07:00"
    expected_result = "07:07 PM"
    result = format_date_time_string(test_date_time)
    assert result == expected_result

env_path = Path('.') / '.env'
load_dotenv(dotenv_path=env_path) # loads environment variables set in a ".env" file
api_key = os.environ.get("TICKETMASTER_API_KEY")
base_url = f"https://app.ticketmaster.com/discovery/v2/events.json"

def test_build_url_no_params():
    keywords = "Knicks"
    expected_url = base_url + f"?keyword={keywords}&size=200" + f"&apikey={api_key}"
    url = build_request_url(keywords)
    assert url == expected_url

def test_build_url_city():
    keywords = "Knicks"
    city = "NY"
    expected_url = base_url + f"?keyword={keywords}&size=200" + f"&city={city}" + f"&apikey={api_key}"
    url = build_request_url(keywords, city, "", "")
    assert url == expected_url

def test_build_url_state():
    keywords = "Knicks"
    state = "NY"
    expected_url = base_url + f"?keyword={keywords}&size=200" + f"&stateCode={state}" + f"&apikey={api_key}"
    url = build_request_url(keywords, "", state, "")
    assert url == expected_url

def test_build_url_country():
    keywords = "Knicks"
    country = "US"
    expected_url = base_url + f"?keyword={keywords}&size=200" + f"&countryCode={country}" + f"&apikey={api_key}"
    url = build_request_url(keywords, "", "", country)
    assert url == expected_url

def test_build_url_city_state_country():
    keywords = "Knicks"
    city = "NY"
    state = "NY"
    country = "US"
    expected_url = base_url + f"?keyword={keywords}&size=200" + f"&city={city}" + f"&stateCode={state}" + f"&countryCode={country}" + f"&apikey={api_key}"
    url = build_request_url(keywords, city, state, country)
    assert url == expected_url

def test_parse_response_no_results():
    no_results_response = {'_links': {'self': {'href': '/discovery/v2/events.json?size=200&countryCode=CA&keyword=J+Balvin'}}, 'page': {'size': 200, 'totalElements': 0, 'totalPages': 0, 'number': 0}}
    success = parse_response(no_results_response)
    assert success == False

def test_parse_response_error():
    error_response = {
        "fault": {
            "faultstring": "Invalid ApiKey",
            "detail": {
                "errorcode": "oauth.v2.InvalidApiKey"
            }
        }
    }
    success = parse_response(error_response)
    assert success == False

def test_parse_response_success():
    success_response = {'_embedded': {'events': [{'name': 'Luke Bryan: What Makes You Country Tour 2018', 'type': 'event', 'id': '1Av7Z46GkMF_bwB', 'test': False, 'url': 'https://www.ticketmaster.ca/luke-bryan-what-makes-you-country-vancouver-british-columbia-10-13-2018/event/1100547DC8658CBA', 'locale': 'en-us', 'images': [{'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_ARTIST_PAGE_3_2.jpg', 'width': 305, 'height': 203, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_RECOMENDATION_16_9.jpg', 'width': 100, 'height': 56, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_TABLET_LANDSCAPE_16_9.jpg', 'width': 1024, 'height': 576, 'fallback': False}, {'ratio': '4_3', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_CUSTOM.jpg', 'width': 305, 'height': 225, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_RETINA_PORTRAIT_3_2.jpg', 'width': 640, 'height': 427, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_TABLET_LANDSCAPE_3_2.jpg', 'width': 1024, 'height': 683, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_TABLET_LANDSCAPE_LARGE_16_9.jpg', 'width': 2048, 'height': 1152, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_EVENT_DETAIL_PAGE_16_9.jpg', 'width': 205, 'height': 115, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_RETINA_PORTRAIT_16_9.jpg', 'width': 640, 'height': 360, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_RETINA_LANDSCAPE_16_9.jpg', 'width': 1136, 'height': 639, 'fallback': False}], 'sales': {'public': {'startDateTime': '2018-04-13T17:00:00Z', 'startTBD': False, 'endDateTime': '2018-10-14T01:00:00Z'}, 'presales': [{'startDateTime': '2018-04-10T15:00:00Z', 'endDateTime': '2018-04-11T16:59:00Z', 'name': 'Fan Club VIP Presale'}, {'startDateTime': '2018-04-10T19:00:00Z', 'endDateTime': '2018-04-13T05:00:00Z', 'name': 'Front Of The Line by American Express', 'description': 'For Front Of The Line Tickets, purchase must be charged in full to an American Express Card. Subject to availability and to event and ticketing agent terms, conditions and fees. Please note: All American Express Cards are eligible for American Express Invites tickets including Cardmembers from other countries outside of Canada.'}, {'startDateTime': '2018-04-11T17:00:00Z', 'endDateTime': '2018-04-13T05:00:00Z', 'name': 'Live Nation Mobile App Presale', 'description': 'ownload the Live Nation iPhone App now to access Live Nation Mobile App Presales. Browse, search, and discover concerts for your favorite artists near you; get alerts on presales, onsales, and last minute tickets; and easily and quickly purchase tickets while in the app. Check out set lists on the go, check in with your friends, view your ticket info, seating charts, exclusive photos, videos and more.', 'url': 'http://www.livenation.com/mobile'}, {'startDateTime': '2018-04-11T17:00:00Z', 'endDateTime': '2018-04-13T05:00:00Z', 'name': 'Facebook Presale'}, {'startDateTime': '2018-04-11T17:00:00Z', 'endDateTime': '2018-04-13T05:00:00Z', 'name': 'JRFM Presale'}, {'startDateTime': '2018-04-11T17:00:00Z', 'endDateTime': '2018-04-13T05:00:00Z', 'name': 'Venue Presale'}, {'startDateTime': '2018-04-11T17:00:00Z', 'endDateTime': '2018-04-13T05:00:00Z', 'name': 'Sam Hunt Fan Club Presale'}, {'startDateTime': '2018-04-11T17:00:00Z', 'endDateTime': '2018-04-13T05:00:00Z', 'name': 'Jon Pardi Fan Club Presale'}, {'startDateTime': '2018-04-11T17:00:00Z', 'endDateTime': '2018-04-13T05:00:00Z', 'name': '1st Of Three Fan Club Presale'}, {'startDateTime': '2018-04-11T17:00:00Z', 'endDateTime': '2018-04-13T05:00:00Z', 'name': "Cabela's Presale"}, {'startDateTime': '2018-04-13T17:00:00Z', 'endDateTime': '2018-10-08T00:00:00Z', 'name': 'VIP Onsale'}, {'startDateTime': '2018-04-11T17:00:00Z', 'endDateTime': '2018-04-13T05:00:00Z', 'name': 'Live Nation Presale', 'description': 'Not a Live Nation member? Sign up to receive Live Nation presale passwords', 'url': 'http://bit.ly/GMW9Ni'}, {'startDateTime': '2018-04-11T17:00:00Z', 'endDateTime': '2018-04-13T05:00:00Z', 'name': 'VIP Package Presale'}]}, 'dates': {'start': {'localDate': '2018-10-13', 'localTime': '16:00:00', 'dateTime': '2018-10-13T23:00:00Z', 'dateTBD': False, 'dateTBA': False, 'timeTBA': False, 'noSpecificTime': False}, 'timezone': 'America/Los_Angeles', 'status': {'code': 'onsale'}, 'spanMultipleDays': False}, 'classifications': [{'primary': True, 'segment': {'id': 'KZFzniwnSyZfZ7v7nJ', 'name': 'Music'}, 'genre': {'id': 'KnvZfZ7vAv6', 'name': 'Country'}, 'subGenre': {'id': 'KZazBEonSMnZfZ7vAFa', 'name': 'Country'}, 'type': {'id': 'KZAyXgnZfZ7v7nI', 'name': 'Undefined'}, 'subType': {'id': 'KZFzBErXgnZfZ7v7lJ', 'name': 'Undefined'}, 'family': False}], 'promoter': {'id': '850', 'name': 'LIVE NATION CANADA (LN)', 'description': 'LIVE NATION CANADA (LN) / NTL / CAN'}, 'promoters': [{'id': '850', 'name': 'LIVE NATION CANADA (LN)', 'description': 'LIVE NATION CANADA (LN) / NTL / CAN'}], 'pleaseNote': 'Doors open at 4pm.', 'priceRanges': [{'type': 'standard', 'currency': 'CAD', 'min': 20.0, 'max': 449.0}], 'seatmap': {'staticUrl': 'https://s1.ticketm.net/tmimages/venue/maps/van/85008s.gif'}, 'accessibility': {'info': 'Wheelchair and companion seating is configured with a 1 to 1 arrangement. Companion seats are provided beside the wheelchair. Additional companion seats may be purchased in sections nearby. \r\n\r\nSeating is on reserved platforms throughout the spectator bowl. All entrances fully accessible. Level 3 suites have removable seats to allow for wheelchair seating. Contact BC Place prior to your event at 604-661-3401 or stadium@bcpavco.com and staff will prepare your suite for you.\r\n\r\nAll washrooms are accessible.\r\n\r\nConstruction activity has relocated parking in Lot 456 to Lot 457 temporarily, which is accessed \r\ndirectly off Pacific Blvd, about 200m past the previous entrance to Lot 456.  \r\nClearly marked with a white tent and accessibility signage, BC Place will also provide an \r\nin-stadium shuttle service from the new entrance to the elevator, before and after your event.\r\n\r\nDepending on show configuration and production staging, some seats may not be open for all events.'}, '_links': {'self': {'href': '/discovery/v2/events/1Av7Z46GkMF_bwB?locale=en-us'}, 'attractions': [{'href': '/discovery/v2/attractions/K8vZ917G4u0?locale=en-us'}, {'href': '/discovery/v2/attractions/K8vZ917opsV?locale=en-us'}, {'href': '/discovery/v2/attractions/K8vZ917ugvf?locale=en-us'}, {'href': '/discovery/v2/attractions/K8vZ9172_40?locale=en-us'}], 'venues': [{'href': '/discovery/v2/venues/KovZpZAJdn6A?locale=en-us'}]}, '_embedded': {'venues': [{'name': 'BC Place', 'type': 'venue', 'id': 'KovZpZAJdn6A', 'test': False, 'url': 'https://www.ticketmaster.ca/bc-place-tickets-vancouver/venue/139268', 'locale': 'en-us', 'images': [{'ratio': '16_9', 'url': 'https://s1.ticketm.net/dbimages/12892v.jpg', 'width': 205, 'height': 115, 'fallback': False}, {'url': 'https://s1.ticketm.net/dam/v/dea/501bed0b-d1bf-47fe-9534-31bc30af4dea_398231_SOURCE.jpg', 'width': 2855, 'height': 2328, 'fallback': False, 'attribution': 'CC BY-SA 3.0 via Wikipedia'}], 'postalCode': 'V6B 4Y8', 'timezone': 'America/Los_Angeles', 'city': {'name': 'Vancouver'}, 'state': {'name': 'British Columbia', 'stateCode': 'BC'}, 'country': {'name': 'Canada', 'countryCode': 'CA'}, 'address': {'line1': '777 Pacific Blvd.'}, 'location': {'longitude': '-123.1127117', 'latitude': '49.2760688'}, 'markets': [{'id': '111'}], 'dmas': [{'id': 504}, {'id': 507}, {'id': 528}, {'id': 529}], 'boxOfficeInfo': {'openHoursDetail': 'Open Monday to Friday from 9:00am to 5:00pm and event days. Holiday Hours Dec 24 9am - 12pm Dec 25 Closed Dec 26 Regular Hours Jan 1 Closed', 'willCallDetail': "Box Office Location: You can pick up your tickets at any sales or service ticketing window outside the venue. Note: Please arrive early if picking up tickets. Customers must present the actual credit card used to place the order and photo ID. 'Team Ticketing Services' has moved to Gate 'H', should you be directed there by any a member of the Team's administration."}, 'parkingDetail': 'Pay parking lots are located adjacent to BC Place.', 'accessibleSeatingDetail': 'Wheelchair seating is located on Levels 2 & 4 and all entrances are accessible. There are a total of 103 wheelchair and 103 attendant locations. Suites are also wheelchair accessible. Hearing Devices: None.', 'generalInfo': {'childRule': "Children Rules: (Please note: Child Policy may vary for different events.) Babes in arms (6 months and under) are admitted free but not encouraged. Children are expected to sit on parents laps, and will not be issued a specific seat. For BC Lions football games: Babes in arms policy will be extended to children under 2 years of age. For Vancouver Whitecaps games: Children age two and under will be admitted free as long as the child is sitting on an adult's lap. If a parent requests a physical seat for the child, he/she must purchase a ticket."}, 'upcomingEvents': {'_total': 21, 'ticketmaster': 21}, '_links': {'self': {'href': '/discovery/v2/venues/KovZpZAJdn6A?locale=en-us'}}}], 'attractions': [{'name': 'Luke Bryan', 'type': 'attraction', 'id': 'K8vZ917G4u0', 'test': False, 'url': 'https://www.ticketmaster.ca/luke-bryan-tickets/artist/1044173', 'locale': 'en-us', 'externalLinks': {'youtube': [{'url': 'https://www.youtube.com/user/lukebryan'}], 'twitter': [{'url': 'https://twitter.com/lukebryanonline'}], 'facebook': [{'url': 'https://www.facebook.com/lukebryan'}], 'wiki': [{'url': 'https://en.wikipedia.org/wiki/Luke_Bryan'}], 'musicbrainz': [{'id': 'aab35942-f176-4f77-bbf9-1d6aa98ccf3f'}], 'homepage': [{'url': 'http://www.lukebryan.com/'}, {'url': 'http://www.capitolnashville.com/ArtistHome.aspx?ArtistID=921888'}]}, 'images': [{'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_ARTIST_PAGE_3_2.jpg', 'width': 305, 'height': 203, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_RECOMENDATION_16_9.jpg', 'width': 100, 'height': 56, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_TABLET_LANDSCAPE_16_9.jpg', 'width': 1024, 'height': 576, 'fallback': False}, {'ratio': '4_3', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_CUSTOM.jpg', 'width': 305, 'height': 225, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_RETINA_PORTRAIT_3_2.jpg', 'width': 640, 'height': 427, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_TABLET_LANDSCAPE_3_2.jpg', 'width': 1024, 'height': 683, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_TABLET_LANDSCAPE_LARGE_16_9.jpg', 'width': 2048, 'height': 1152, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_EVENT_DETAIL_PAGE_16_9.jpg', 'width': 205, 'height': 115, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_RETINA_PORTRAIT_16_9.jpg', 'width': 640, 'height': 360, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/eb0/ba1a7ffa-79a3-4974-8abb-9d4b2a412eb0_588091_RETINA_LANDSCAPE_16_9.jpg', 'width': 1136, 'height': 639, 'fallback': False}], 'classifications': [{'primary': True, 'segment': {'id': 'KZFzniwnSyZfZ7v7nJ', 'name': 'Music'}, 'genre': {'id': 'KnvZfZ7vAv6', 'name': 'Country'}, 'subGenre': {'id': 'KZazBEonSMnZfZ7vAFa', 'name': 'Country'}, 'type': {'id': 'KZAyXgnZfZ7v7nI', 'name': 'Undefined'}, 'subType': {'id': 'KZFzBErXgnZfZ7v7lJ', 'name': 'Undefined'}, 'family': False}], 'upcomingEvents': {'_total': 53, 'tmr': 17, 'ticketmaster': 36}, '_links': {'self': {'href': '/discovery/v2/attractions/K8vZ917G4u0?locale=en-us'}}}, {'name': 'Sam Hunt', 'type': 'attraction', 'id': 'K8vZ917opsV', 'test': False, 'url': 'https://www.ticketmaster.ca/sam-hunt-tickets/artist/1881653', 'locale': 'en-us', 'externalLinks': {'twitter': [{'url': 'https://twitter.com/SamHuntMusic'}], 'itunes': [{'url': 'https://itunes.apple.com/us/artist/id214150835'}], 'lastfm': [{'url': 'http://www.last.fm/music/Sam+Hunt'}], 'facebook': [{'url': 'https://www.facebook.com/SamHuntMusic'}], 'wiki': [{'url': 'https://en.wikipedia.org/wiki/Sam_Hunt_(musician)'}], 'musicbrainz': [{'id': 'b27229bb-5669-4e98-b4ce-0158b2451fe8'}], 'homepage': [{'url': 'http://www.samhunt.com/'}]}, 'images': [{'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/2e6/3ca804ab-797f-4e71-a9ff-961ea372a2e6_624201_TABLET_LANDSCAPE_LARGE_16_9.jpg', 'width': 2048, 'height': 1152, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/2e6/3ca804ab-797f-4e71-a9ff-961ea372a2e6_624201_ARTIST_PAGE_3_2.jpg', 'width': 305, 'height': 203, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/2e6/3ca804ab-797f-4e71-a9ff-961ea372a2e6_624201_RECOMENDATION_16_9.jpg', 'width': 100, 'height': 56, 'fallback': False}, {'ratio': '4_3', 'url': 'https://s1.ticketm.net/dam/a/2e6/3ca804ab-797f-4e71-a9ff-961ea372a2e6_624201_CUSTOM.jpg', 'width': 305, 'height': 225, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/2e6/3ca804ab-797f-4e71-a9ff-961ea372a2e6_624201_TABLET_LANDSCAPE_3_2.jpg', 'width': 1024, 'height': 683, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/2e6/3ca804ab-797f-4e71-a9ff-961ea372a2e6_624201_RETINA_PORTRAIT_3_2.jpg', 'width': 640, 'height': 427, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/2e6/3ca804ab-797f-4e71-a9ff-961ea372a2e6_624201_TABLET_LANDSCAPE_16_9.jpg', 'width': 1024, 'height': 576, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/2e6/3ca804ab-797f-4e71-a9ff-961ea372a2e6_624201_RETINA_PORTRAIT_16_9.jpg', 'width': 640, 'height': 360, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/2e6/3ca804ab-797f-4e71-a9ff-961ea372a2e6_624201_EVENT_DETAIL_PAGE_16_9.jpg', 'width': 205, 'height': 115, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/2e6/3ca804ab-797f-4e71-a9ff-961ea372a2e6_624201_RETINA_LANDSCAPE_16_9.jpg', 'width': 1136, 'height': 639, 'fallback': False}], 'classifications': [{'primary': True, 'segment': {'id': 'KZFzniwnSyZfZ7v7nJ', 'name': 'Music'}, 'genre': {'id': 'KnvZfZ7vAv6', 'name': 'Country'}, 'subGenre': {'id': 'KZazBEonSMnZfZ7vAFa', 'name': 'Country'}, 'type': {'id': 'KZAyXgnZfZ7v7nI', 'name': 'Undefined'}, 'subType': {'id': 'KZFzBErXgnZfZ7v7lJ', 'name': 'Undefined'}, 'family': False}], 'upcomingEvents': {'_total': 18, 'tmr': 4, 'ticketmaster': 14}, '_links': {'self': {'href': '/discovery/v2/attractions/K8vZ917opsV?locale=en-us'}}}, {'name': 'Jon Pardi', 'type': 'attraction', 'id': 'K8vZ917ugvf', 'test': False, 'url': 'https://www.ticketmaster.ca/jon-pardi-tickets/artist/1541267', 'locale': 'en-us', 'externalLinks': {'twitter': [{'url': 'https://twitter.com/JonPardi'}], 'wiki': [{'url': 'https://en.wikipedia.org/wiki/Jon_Pardi'}], 'musicbrainz': [{'id': 'ad590765-191c-4c07-9d64-49633488e9a8'}]}, 'images': [{'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/d09/0dacd673-976b-4821-a34b-f8cf41090d09_143911_RETINA_PORTRAIT_3_2.jpg', 'width': 640, 'height': 427, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/d09/0dacd673-976b-4821-a34b-f8cf41090d09_143911_EVENT_DETAIL_PAGE_16_9.jpg', 'width': 205, 'height': 115, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/d09/0dacd673-976b-4821-a34b-f8cf41090d09_143911_TABLET_LANDSCAPE_16_9.jpg', 'width': 1024, 'height': 576, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/d09/0dacd673-976b-4821-a34b-f8cf41090d09_143911_RETINA_LANDSCAPE_16_9.jpg', 'width': 1136, 'height': 639, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/d09/0dacd673-976b-4821-a34b-f8cf41090d09_143911_RECOMENDATION_16_9.jpg', 'width': 100, 'height': 56, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/d09/0dacd673-976b-4821-a34b-f8cf41090d09_143911_TABLET_LANDSCAPE_LARGE_16_9.jpg', 'width': 2048, 'height': 1152, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/d09/0dacd673-976b-4821-a34b-f8cf41090d09_143911_ARTIST_PAGE_3_2.jpg', 'width': 305, 'height': 203, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/d09/0dacd673-976b-4821-a34b-f8cf41090d09_143911_RETINA_PORTRAIT_16_9.jpg', 'width': 640, 'height': 360, 'fallback': False}, {'ratio': '4_3', 'url': 'https://s1.ticketm.net/dam/a/d09/0dacd673-976b-4821-a34b-f8cf41090d09_143911_CUSTOM.jpg', 'width': 305, 'height': 225, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/d09/0dacd673-976b-4821-a34b-f8cf41090d09_143911_TABLET_LANDSCAPE_3_2.jpg', 'width': 1024, 'height': 683, 'fallback': False}], 'classifications': [{'primary': True, 'segment': {'id': 'KZFzniwnSyZfZ7v7nJ', 'name': 'Music'}, 'genre': {'id': 'KnvZfZ7vAv6', 'name': 'Country'}, 'subGenre': {'id': 'KZazBEonSMnZfZ7vAFa', 'name': 'Country'}, 'type': {'id': 'KZAyXgnZfZ7v7nI', 'name': 'Undefined'}, 'subType': {'id': 'KZFzBErXgnZfZ7v7lJ', 'name': 'Undefined'}, 'family': False}], 'upcomingEvents': {'_total': 47, 'tmr': 14, 'ticketmaster': 33}, '_links': {'self': {'href': '/discovery/v2/attractions/K8vZ917ugvf?locale=en-us'}}}, {'name': 'Carly Pearce', 'type': 'attraction', 'id': 'K8vZ9172_40', 'test': False, 'url': 'https://www.ticketmaster.ca/carly-pearce-tickets/artist/1686542', 'locale': 'en-us', 'externalLinks': {'musicbrainz': [{'id': '199affdb-93c0-4a9d-a4d0-26dc4fa01806'}], 'homepage': [{'url': 'http://www.carlypearce.com/'}]}, 'images': [{'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/c/677/c58dd0af-cda8-49b2-bdaf-068540c3a677_106541_RETINA_LANDSCAPE_16_9.jpg', 'width': 1136, 'height': 639, 'fallback': True}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/c/677/c58dd0af-cda8-49b2-bdaf-068540c3a677_106541_ARTIST_PAGE_3_2.jpg', 'width': 305, 'height': 203, 'fallback': True}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/c/677/c58dd0af-cda8-49b2-bdaf-068540c3a677_106541_RETINA_PORTRAIT_3_2.jpg', 'width': 640, 'height': 427, 'fallback': True}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/c/677/c58dd0af-cda8-49b2-bdaf-068540c3a677_106541_RETINA_PORTRAIT_16_9.jpg', 'width': 640, 'height': 360, 'fallback': True}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/c/677/c58dd0af-cda8-49b2-bdaf-068540c3a677_106541_RECOMENDATION_16_9.jpg', 'width': 100, 'height': 56, 'fallback': True}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/c/677/c58dd0af-cda8-49b2-bdaf-068540c3a677_106541_EVENT_DETAIL_PAGE_16_9.jpg', 'width': 205, 'height': 115, 'fallback': True}, {'ratio': '4_3', 'url': 'https://s1.ticketm.net/dam/c/677/c58dd0af-cda8-49b2-bdaf-068540c3a677_106541_CUSTOM.jpg', 'width': 305, 'height': 225, 'fallback': True}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/c/677/c58dd0af-cda8-49b2-bdaf-068540c3a677_106541_TABLET_LANDSCAPE_16_9.jpg', 'width': 1024, 'height': 576, 'fallback': True}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/c/677/c58dd0af-cda8-49b2-bdaf-068540c3a677_106541_TABLET_LANDSCAPE_3_2.jpg', 'width': 1024, 'height': 683, 'fallback': True}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/c/677/c58dd0af-cda8-49b2-bdaf-068540c3a677_106541_TABLET_LANDSCAPE_LARGE_16_9.jpg', 'width': 2048, 'height': 1152, 'fallback': True}], 'classifications': [{'primary': True, 'segment': {'id': 'KZFzniwnSyZfZ7v7nJ', 'name': 'Music'}, 'genre': {'id': 'KnvZfZ7vAv6', 'name': 'Country'}, 'subGenre': {'id': 'KZazBEonSMnZfZ7vAFI', 'name': 'Bluegrass'}, 'type': {'id': 'KZAyXgnZfZ7v7nI', 'name': 'Undefined'}, 'subType': {'id': 'KZFzBErXgnZfZ7v7lJ', 'name': 'Undefined'}, 'family': False}], 'upcomingEvents': {'_total': 31, 'tmr': 4, 'ticketmaster': 27}, '_links': {'self': {'href': '/discovery/v2/attractions/K8vZ9172_40?locale=en-us'}}}]}}, {'name': 'Oh What A Night! A Musical Tribute To Frankie Valli and the Four Seasons', 'type': 'event', 'id': '1AoZA37GkeV-IaW', 'test': False, 'url': 'https://www.ticketmaster.ca/oh-what-a-night-a-musical-winnipeg-manitoba-11-25-2018/event/11005484B486827D', 'locale': 'en-us', 'images': [{'ratio': '16_9', 'url': 'https://s1.ticketm.net/dbimages/153099a.jpg', 'width': 205, 'height': 115, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_RECOMENDATION_16_9.jpg', 'width': 100, 'height': 56, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_RETINA_LANDSCAPE_16_9.jpg', 'width': 1136, 'height': 639, 'fallback': False}, {'ratio': '4_3', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_CUSTOM.jpg', 'width': 305, 'height': 225, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_TABLET_LANDSCAPE_16_9.jpg', 'width': 1024, 'height': 576, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_ARTIST_PAGE_3_2.jpg', 'width': 305, 'height': 203, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_RETINA_PORTRAIT_3_2.jpg', 'width': 640, 'height': 427, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_TABLET_LANDSCAPE_3_2.jpg', 'width': 1024, 'height': 683, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_RETINA_PORTRAIT_16_9.jpg', 'width': 640, 'height': 360, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_TABLET_LANDSCAPE_LARGE_16_9.jpg', 'width': 2048, 'height': 1152, 'fallback': False}], 'sales': {'public': {'startDateTime': '2018-04-12T15:00:00Z', 'startTBD': False, 'endDateTime': '2018-11-26T03:00:00Z'}, 'presales': [{'startDateTime': '2018-04-11T15:00:00Z', 'endDateTime': '2018-04-12T03:00:00Z', 'name': 'Club Card Presale', 'description': 'Club Card Presale online with password, or in person with Club Card at Casino Box Offices'}]}, 'dates': {'start': {'localDate': '2018-11-25', 'localTime': '19:00:00', 'dateTime': '2018-11-26T01:00:00Z', 'dateTBD': False, 'dateTBA': False, 'timeTBA': False, 'noSpecificTime': False}, 'timezone': 'America/Winnipeg', 'status': {'code': 'onsale'}, 'spanMultipleDays': False}, 'classifications': [{'primary': True, 'segment': {'id': 'KZFzniwnSyZfZ7v7nJ', 'name': 'Music'}, 'genre': {'id': 'KnvZfZ7vAe6', 'name': 'Undefined'}, 'subGenre': {'id': 'KZazBEonSMnZfZ7v6JI', 'name': 'Undefined'}, 'type': {'id': 'KZAyXgnZfZ7v7l1', 'name': 'Group'}, 'subType': {'id': 'KZFzBErXgnZfZ7vAAI', 'name': 'Tribute Band'}, 'family': False}], 'promoter': {'id': '894', 'name': 'MANITOBA LOTTERIES CORPORATION (CANADA)', 'description': 'MANITOBA LOTTERIES CORPORATION (CANADA) / NTL / CAN'}, 'promoters': [{'id': '894', 'name': 'MANITOBA LOTTERIES CORPORATION (CANADA)', 'description': 'MANITOBA LOTTERIES CORPORATION (CANADA) / NTL / CAN'}], 'pleaseNote': 'No Minors. Must be 18 years or older to attend. Government ID required', 'priceRanges': [{'type': 'standard', 'currency': 'CAD', 'min': 57.5, 'max': 57.5}], 'seatmap': {'staticUrl': 'https://s1.ticketm.net/tmimages/venue/maps/van/53710s.gif'}, 'accessibility': {'info': 'Wheelchair and companion seating is available with a 1 to 1 arrangement on the passageway between the lower and upper Theatre sections, in front of row 12 Centre.  A chair will be provided for the companion, who will be seated directly beside the wheelchair space.  Additional companion seats may be purchased in the adjoining sections, subject to availability. \r\n\r\nSight_Hearing accessible seating is located in Row 5 Right. \r\n\r\nDepending on show configuration and production requirements, some sections may not be available for all events.'}, '_links': {'self': {'href': '/discovery/v2/events/1AoZA37GkeV-IaW?locale=en-us'}, 'attractions': [{'href': '/discovery/v2/attractions/K8vZ917o47f?locale=en-us'}], 'venues': [{'href': '/discovery/v2/venues/KovZpZAEee7A?locale=en-us'}]}, '_embedded': {'venues': [{'name': 'Club Regent Event Centre', 'type': 'venue', 'id': 'KovZpZAEee7A', 'test': False, 'url': 'https://www.ticketmaster.ca/club-regent-event-centre-tickets-winnipeg/venue/139542', 'locale': 'en-us', 'images': [{'ratio': '16_9', 'url': 'https://s1.ticketm.net/dbimages/16234v.gif', 'width': 205, 'height': 115, 'fallback': False}], 'postalCode': 'R2C 3B2', 'timezone': 'America/Winnipeg', 'city': {'name': 'Winnipeg'}, 'state': {'name': 'Manitoba', 'stateCode': 'MB'}, 'country': {'name': 'Canada', 'countryCode': 'CA'}, 'address': {'line1': '1425 Regent Ave. W.'}, 'location': {'longitude': '-97.0441598', 'latitude': '49.8954192'}, 'markets': [{'id': '106'}], 'dmas': [{'id': 530}], 'boxOfficeInfo': {'phoneNumberDetail': 'General Info Line: 1-204-957-2500 Toll Free: 1-800-265-3912', 'openHoursDetail': 'Monday to Saturday: 10:00am - 10:30pm Sunday: 12:00pm - 7:00pm Call or check the website for closure details.', 'acceptedPaymentDetail': 'Visa, MC, American Express, Cash and Debit', 'willCallDetail': 'Note: Please arrive at the box office early if picking up tickets. Customers must present both the credit card the tickets were purchased with and photo ID when picking up tickets. Only the Credit Card owner may pick up the tickets.'}, 'parkingDetail': 'Accessible Parking located in close proximity to the various entrance doors around the property. Valet parking available ($5.00 or $2.50 with Club Card)', 'accessibleSeatingDetail': 'The Event Centre concert venue has rows of seats with stairs. Only tickets purchased for seats in the accessible section (Ground Level, Row 11) may be accessed by wheelchair. Hearing Devices: none', 'generalInfo': {'childRule': 'Shows are all ages, unless otherwise stated.'}, 'upcomingEvents': {'_total': 26, 'ticketmaster': 26}, 'ada': {'adaPhones': 'Ticketmaster: 1-855-682-6736 or any other Ticketmaster Charge by Phone Number', 'adaCustomCopy': 'Customers who require accessible seating options including customers with visual disabilities, or who are otherwise unable to complete a ticket purchase online, please call Ticketmaster Charge by Phone.', 'adaHours': 'Ticketmaster: Mondays to Saturdays 9:30am to 10pm EST; Sundays and statutory holidays from 12 noon to 8pm EST'}, '_links': {'self': {'href': '/discovery/v2/venues/KovZpZAEee7A?locale=en-us'}}}], 'attractions': [{'name': 'Oh What A Night! A Musical Tribute To Frankie Valli and the Four Seasons', 'type': 'attraction', 'id': 'K8vZ917o47f', 'test': False, 'url': 'https://www.ticketmaster.ca/oh-what-a-night-a-musical-tickets/artist/1879233', 'locale': 'en-us', 'images': [{'ratio': '16_9', 'url': 'https://s1.ticketm.net/dbimages/153099a.jpg', 'width': 205, 'height': 115, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_RECOMENDATION_16_9.jpg', 'width': 100, 'height': 56, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_RETINA_LANDSCAPE_16_9.jpg', 'width': 1136, 'height': 639, 'fallback': False}, {'ratio': '4_3', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_CUSTOM.jpg', 'width': 305, 'height': 225, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_TABLET_LANDSCAPE_16_9.jpg', 'width': 1024, 'height': 576, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_ARTIST_PAGE_3_2.jpg', 'width': 305, 'height': 203, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_RETINA_PORTRAIT_3_2.jpg', 'width': 640, 'height': 427, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_TABLET_LANDSCAPE_3_2.jpg', 'width': 1024, 'height': 683, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_RETINA_PORTRAIT_16_9.jpg', 'width': 640, 'height': 360, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/351/78483da2-9cf7-4997-86da-f33f6dad4351_188971_TABLET_LANDSCAPE_LARGE_16_9.jpg', 'width': 2048, 'height': 1152, 'fallback': False}], 'classifications': [{'primary': True, 'segment': {'id': 'KZFzniwnSyZfZ7v7nJ', 'name': 'Music'}, 'genre': {'id': 'KnvZfZ7vAe6', 'name': 'Undefined'}, 'subGenre': {'id': 'KZazBEonSMnZfZ7v6JI', 'name': 'Undefined'}, 'type': {'id': 'KZAyXgnZfZ7v7l1', 'name': 'Group'}, 'subType': {'id': 'KZFzBErXgnZfZ7vAAI', 'name': 'Tribute Band'}, 'family': False}], 'upcomingEvents': {'_total': 1, 'ticketmaster': 1}, '_links': {'self': {'href': '/discovery/v2/attractions/K8vZ917o47f?locale=en-us'}}}]}}]}, '_links': {'self': {'href': '/discovery/v2/events.json?size=200&countryCode=CA&keyword=What'}}, 'page': {'size': 200, 'totalElements': 2, 'totalPages': 1, 'number': 0}}

    success = parse_response(success_response)
    assert success == True
